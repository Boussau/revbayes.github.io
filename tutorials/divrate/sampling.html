<!doctype html>
<html lang="en">
<link rel="icon" type="image/png" href="/assets/img/favicon.png" >
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="search-domain" value="https://revbayes.github.io/">
    <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">
    <link rel="stylesheet" href="/assets/css/syntax.css">
    <link rel="stylesheet" type="text/css" href="/assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/main.css" />
    <title>RevBayes: Diversification Rate Estimation with Missing Taxa</title>
  </head>
  <body>
    <div class="container">
      <nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <a href="/" class="pull-left">
        
        <img class="navbar-logo" src="/assets/img/aquabayes-desaturated.png" alt="RevBayes Home" />
        
      </a>
      
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar" align="right"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li><a href="/software">Software</a></li>
        <li><a href="/tutorials/">Tutorials</a></li>
        <li><a href="/workshops/">Workshops</a></li>
        <li><a href="/jobs/">Jobs</a></li>
        <li><a href="/developer/">Developer</a></li>
        
      </ul>
      <!-- <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form> -->
    </div>
  </div>
</nav>

      <div class="titlebar">
	<h1 class="maintitle">Diversification Rate Estimation with Missing Taxa</h1>
	<h3 class="subtitle">How to estimate diversification rates with incomplete taxon sampling</h3>
	<h4 class="authors">Sebastian Höhna, Will Freyman and Mike May</h4>
  <h5>Last modified on December 11, 2018</h5>
</div>


<div class="sidebar no-print">
<blockquote class="overview" id="overview">
  <h2>Overview</h2>
  
  <div class="row">
    <div class="col-md-9">
        <strong>Prerequisites</strong>
        
          <ul id="prerequisites">
          
            <li><a href="/tutorials/intro/">Rev Language Syntax</a></li>
          
            <li><a href="/tutorials/divrate/div_rate_intro.html">Introduction to Diversification Rate Estimation</a></li>
          
          </ul>
        
    </div>
  </div>
  
</blockquote>





<blockquote class="tutorial_files" id="tutorial_files">
    <h2>Data files and scripts</h2>
    
        
        <strong>Data Files</strong>
        <ul id="data_files">
        
        
        
          <li><a href="/tutorials/divrate/data/primates.tre">primates.tre</a></li>
        
          <li><a href="/tutorials/divrate/data/primates_tree.nex">primates_tree.nex</a></li>
        
        </ul>
    
        
        <strong>Scripts</strong>
        <ul id="scripts">
        
        
        
          <li><a href="/tutorials/divrate/scripts/mcmc_BD.Rev">mcmc_BD.Rev</a></li>
        
          <li><a href="/tutorials/divrate/scripts/mcmc_BDS.Rev">mcmc_BDS.Rev</a></li>
        
          <li><a href="/tutorials/divrate/scripts/mcmc_EBD.Rev">mcmc_EBD.Rev</a></li>
        
          <li><a href="/tutorials/divrate/scripts/mcmc_EBD_Corr.Rev">mcmc_EBD_Corr.Rev</a></li>
        
          <li><a href="/tutorials/divrate/scripts/mcmc_EBD_Corr_RJ.Rev">mcmc_EBD_Corr_RJ.Rev</a></li>
        
          <li><a href="/tutorials/divrate/scripts/mcmc_Yule.Rev">mcmc_Yule.Rev</a></li>
        
          <li><a href="/tutorials/divrate/scripts/mcmc_Yule_prior.Rev">mcmc_Yule_prior.Rev</a></li>
        
          <li><a href="/tutorials/divrate/scripts/ml_BD.Rev">ml_BD.Rev</a></li>
        
          <li><a href="/tutorials/divrate/scripts/ml_Yule.Rev">ml_Yule.Rev</a></li>
        
          <li><a href="/tutorials/divrate/scripts/plot.R">plot.R</a></li>
        
          <li><a href="/tutorials/divrate/scripts/plot_BDS.R">plot_BDS.R</a></li>
        
        </ul>
    
</blockquote>


</div>
<h1 id="sec:diversification_rate_overview">Overview: Diversification Rate Estimation</h1>

<p>Models of speciation and extinction are fundamental to any phylogenetic
analysis of macroevolutionary processes
(<em>e.g.,</em> divergence time estimation,
diversification rate estimation, continuous and discrete trait
evolution, and historical biogeography). First, a prior model describing
the distribution of speciation events over time is critical to
estimating phylogenies with branch lengths proportional to time. Second,
stochastic branching models allow for inference of speciation and
extinction rates. These inferences allow us to investigate key questions
in evolutionary biology.</p>

<p>Diversification-rate parameters may be included as nuisance parameters
of other phylogenetic models—<em>i.e.,</em>where
these diversification-rate parameters are not of direct interest. For
example, many methods for estimating species divergence times—such as
<code class="highlighter-rouge">BEAST</code><a href="#Drummond2012">(Drummond et al. 2012)</a>,
<code class="highlighter-rouge">MrBayes</code><a href="#Ronquist2012">(Ronquist et al. 2012)</a>, and <code class="highlighter-rouge">RevBayes</code>
<a href="#Hoehna2016b">(Höhna et al. 2016)</a>—implement ‘relaxed-clock models’ that include a
constant-rate birth-death branching process as a prior model on the
distribution of tree topologies and node ages. Although the parameters
of these ‘tree priors’ are not typically of direct interest, they are
nevertheless estimated as part of the joint posterior probability
distribution of the relaxed-clock model, and so can be estimated simply
by querying the corresponding marginal posterior probability densities.
In fact, this may provide more robust estimates of the
diversification-rate parameters, as they accommodate uncertainty in the
other phylogenetic-model parameters (including the tree topology,
divergence-time estimates, and the other relaxed-clock model
parameters). More recent work,
<em>e.g.,</em><a href="#Heath2014">(Heath et al. 2014)</a>, uses macroevolutionary
models (the fossilized birth-death process) to calibrate phylogenies and
thus to infer dated trees.</p>

<p>In these tutorials we focus on the different types of macroevolutionary
models to study diversification processes and thus the
diversification-rate parameters themselves. Nevertheless, these
macroevolutionary models should be used for other evolutionary
questions, when an appropriate prior distribution on the tree and
divergence times is needed.</p>

<h2 id="types-of-hypotheses-for-estimating-diversification-rates">Types of Hypotheses for Estimating Diversification Rates</h2>

<p>Many evolutionary phenomena entail differential rates of diversification
(speciation – extinction); <em>e.g.,</em>adaptive
radiation, diversity-dependent diversification, key innovations, and
mass extinction. The specific study questions regarding lineage
diversification may be classified within three fundamental categories of
inference problems. Admittedly, this classification scheme is somewhat
arbitrary, but it is nevertheless useful, as it allows users to navigate
the ever-increasing number of available phylogenetic methods. Below, we
describe each of the fundamental questions regarding diversification
rates.</p>

<h4 id="1-diversification-rate-through-time-estimation">(1) Diversification-rate through time estimation</h4>

<p><em>What is the (constant) rate of diversification in my study group?</em> The
most basic models estimate parameters of the stochastic-branching
process (<em>i.e.,</em>rates of speciation and
extinction, or composite parameters such as net-diversification and
relative-extinction rates) under the assumption that rates have remained
constant across lineages and through time;
<em>i.e.,</em>under a constant-rate birth-death
stochastic-branching process model <a href="#Nee1994b">(Nee et al. 1994)</a>. Extensions to the
(basic) constant-rate models include diversification-rate variation
through time (missing reference). First, we might ask whether
there is evidence of an episodic, tree-wide increase in diversification
rates (associated with a sudden increase in speciation rate and/or
decrease in extinction rate), as might occur during an episode of
adaptive radiation. A second question asks whether there is evidence of
a continuous/gradual decrease in diversification rates through time
(associated with decreasing speciation rates and/or increasing
extinction rates), as might occur because of diversity-dependent
diversification (<em>i.e.,</em>where competitive
ecological interactions among the species of a growing tree decrease the
opportunities for speciation and/or increase the probability of
extinction, <em>e.g.,</em><a href="#Hoehna2014a">(Höhna 2014)</a>). Third, we
can ask whether changes in diversification rates are correlated with
environmental factors, such as environmental CO~2~ or temperature
<a href="#Condamine2013">(Condamine et al. 2013)</a>. A final question in this category asks whether our
study tree was impacted by a mass-extinction event (where a large
fraction of the standing species diversity is suddenly lost,
<em>e.g.,</em><a href="#May2016">(May et al. 2016)</a>). The common theme of these
studies is that the diversification process is tree-wide, that is, all
lineages of the study group have the exact same rates at a given time.</p>

<h4 id="2-diversification-rate-variation-across-branches-estimation">(2) Diversification-rate variation across branches estimation</h4>

<p><em>Is there evidence that diversification rates have varied significantly
across the branches of my study group?</em> Models have been developed to
detect departures from rate constancy across lineages; these tests are
analogous to methods that test for departures from a molecular
clock—<em>i.e.,</em>to assess whether substitution
rates vary significantly across lineages (missing reference).
These models are important for assessing whether a given tree violates
the assumptions of rate homogeneity among lineages. Furthermore, these
models are important to answer questions such as: <em>What are the
branch-specific diversification rates?</em>; and <em>Have there been
significant diversification-rate shifts along branches in my study
group, and if so, how many shifts, what magnitude of rate-shifts and
along which branches?</em></p>

<h4 id="3-character-dependent-diversification-rate-estimation">(3) Character-dependent diversification-rate estimation</h4>

<p><em>Are diversification rates correlated with some variable in my study
group?</em> Character-dependent diversification-rate models aim to identify
overall correlations between diversification rates and organismal
features (binary and multi-state discrete morphological traits,
continuous morphological traits, geographic range, etc.). For example,
one can hypothesize that a binary character, say if an organism is
herbivorous/carnivorous or self-compatible/self-incompatible, impact the
diversification rates. Then, if the organism is in state 0
(<em>e.g.,</em>is herbivorous) it has a lower (or
higher) diversification rate than if the organism is in state 1
(<em>e.g.,</em>carnivorous) <a href="#Maddison2007">(Maddison et al. 2007)</a>.</p>

<h1 id="sec:models">Diversification Rate Models</h1>

<p>We begin this section with a general introduction to the stochastic
birth-death branching process that underlies inference of
diversification rates in <code class="highlighter-rouge">RevBayes</code>. This primer will provide some
details on the relevant theory of stochastic-branching process models.
We appreciate that some readers may want to skip this somewhat technical
primer; however, we believe that a better understanding of the relevant
theory provides a foundation for performing better inferences. We then
discuss a variety of specific birth-death models, but emphasize that
these examples represent only a tiny fraction of the possible
diversification-rate models that can be specified in <code class="highlighter-rouge">RevBayes</code>.</p>

<h2 id="the-birth-death-branching-process">The birth-death branching process</h2>

<p>Our approach is based on the <em>reconstructed evolutionary process</em>
described by <a href="#Nee1994b">(Nee et al. 1994)</a>; a birth-death process in which only sampled,
extant lineages are observed. Let $N(t)$ denote the number of species at
time $t$. Assume the process starts at time $t_1$ (the ‘crown’ age of
the most recent common ancestor of the study group, $t_\text{MRCA}$)
when there are two species. Thus, the process is initiated with two
species, $N(t_1) = 2$. We condition the process on sampling at least one
descendant from each of these initial two lineages; otherwise $t_1$
would not correspond to the $t_\text{MRCA}$ of our study group. Each
lineage evolves independently of all other lineages, giving rise to
exactly one new lineage with rate $b(t)$ and losing one existing lineage
with rate $d(t)$ (Figure [fig:BirthDeathShift] and
Figure [fig:BDP]). Note that although each lineage evolves
independently, all lineages share both a common (tree-wide) speciation
rate $b(t)$ and a common extinction rate $d(t)$
(missing reference). Additionally, at certain times,
$t_{\mathbb{M}}$, a mass-extinction event occurs and each species
existing at that time has the same probability, $\rho$, of survival.
Finally, all extinct lineages are pruned and only the reconstructed tree
remains (Figure [fig:BirthDeathShift]).</p>

<p>![A realization of the birth-death process with mass extinction.
Lineages that have no extant or sampled descendant are shown in gray and
surviving lineages are shown in a thicker black line.<span data-label="fig:BirthDeathShift">](\ResourcePath figures/BirthDeathShift.pdf){width=”80.00000%”}</span></p>

<blockquote class="figure">
  <p><img src="figures/BirthDeathShift.png" alt="" /> 
A realization of the
birth-death process with mass extinction. Lineages that have no extant
or sampled descendant are shown in gray and surviving lineages are shown
in a thicker black line.</p>
</blockquote>

<p>![ The process is initiated at the first speciation event (the
‘crown-age’ of the MRCA) when there are two initial lineages. At each
speciation event the ancestral lineage is replaced by two descendant
lineages. At an extinction event one lineage simply terminates. (A) A
complete tree including extinct lineages. (B) The reconstructed tree of
tree from A with extinct lineages pruned away. (C) A <em>uniform</em> subsample
of the tree from B, where each species was sampled with equal
probability, $\rho$. (D) A <em>diversified</em> subsample of the tree from B,
where the species were selected so as to maximize diversity.<span data-label="fig:BDP">](\ResourcePath figures/birth-death-sketch.pdf){width=”\textwidth”}</span></p>

<blockquote class="figure">
  <p><img src="figures/birth-death-sketch.png" alt="" /> 
<strong>Examples of
trees produced under a birth-death process.</strong> The process is
initiated at the first speciation event (the ‘crown-age’ of the MRCA)
when there are two initial lineages. At each speciation event the
ancestral lineage is replaced by two descendant lineages. At an
extinction event one lineage simply terminates. (A) A complete tree
including extinct lineages. (B) The reconstructed tree of tree from A
with extinct lineages pruned away. (C) A <em>uniform</em> subsample of the tree
from B, where each species was sampled with equal probability, $\rho$.
(D) A <em>diversified</em> subsample of the tree from B, where the species were
selected so as to maximize diversity.</p>
</blockquote>

<p>To condition the probability of observing the branching times on the
survival of both lineages that descend from the root, we divide by
$P(N(T) &gt; 0 | N(0) = 1)^2$. Then, the probability density of the
branching times, $\mathbb{T}$, becomes <script type="math/tex">\begin{aligned}
P(\mathbb{T}) = \fra\frac{}{b}ace{P(N(T) = 1 \mid N(0) = 1)^2}^{\text{both initial lineages have one descendant}}}{ \underbrace{P(N(T) > 0 \mid N(0) = 1)^2}_{\text{both initial lineages survive}} } \times \prod_{i=2}^{n-1\frac{ }{b}ace{i \times b(t_i)}^{\text{speciation rate}} \time\frac{ }{b}ace{P(N(T) = 1 \mid N(t_i) = 1)}^\text{lineage has one descendant},\end{aligned}</script>
and the probability density of the reconstructed tree (topology and
branching times) is then <script type="math/tex">% <![CDATA[
\begin{aligned}
P(\Psi) = \; & \frac{2^{n-1}}{n!(n-1)!} \times \left( \frac{P(N(T) = 1 \mid N(0) = 1)}{P(N(T) > 0 \mid N(0) = 1)} \right)^2 \nonumber\\
		  \; & \times \prod_{i=2}^{n-1} i \times b(t_i) \times P(N(T) = 1 \mid N(t_i) = 1)
	\label{eq:tree_probability}\end{aligned} %]]></script></p>

<p>We can expand Equation ([eq:tree_probability]) by substituting
$P(N(T) &gt; 0 \mid N(t) =1)^2 \exp(r(t,T))$ for
$P(N(T) = 1 \mid N(t) = 1)$, where $r(u,v) = \int^v_u d(t)-b(t)dt$; the
above equation becomes <script type="math/tex">% <![CDATA[
\begin{aligned}
P(\Psi) = \; & \frac{2^{n-1}}{n!(n-1)!} \times \left( \frac{P(N(T) > 0 \mid N(0) =1 )^2 \exp(r(0,T))}{P(N(T) > 0 \mid N(0) = 1)} \right)^2 \nonumber\\
		  \; & \times \prod_{i=2}^{n-1} i \times b(t_i) \times P(N(T) > 0 \mid N(t_i) = 1)^2 \exp(r(t_i,T)) \nonumber\\
		= \; & \frac{2^{n-1}}{n!} \times \Big(P(N(T) > 0 \mid N(0) =1 ) \exp(r(0,T))\Big)^2 \nonumber\\
		  \; & \times \prod_{i=2}^{n-1} b(t_i) \times P(N(T) > 0 \mid N(t_i) = 1)^2 \exp(r(t_i,T)).
		\label{eq:tree_probability_substitution}\end{aligned} %]]></script> For a detailed
description of this substitution, see <a href="#Hoehna2015a">(Höhna 2015)</a>. Additional
information regarding the underlying birth-death process can be found in
@Thompson1975 [Equation 3.4.6] and <a href="#Nee1994b">(Nee et al. 1994)</a> for constant rates and
(missing reference) for arbitrary rate functions.</p>

<p>To compute the equation above we need to know the rate function,
$r(t,s) = \int_t^s d(x)-b(x) dx$, and the probability of survival,
$P(N(T)!&gt;!0|N(t)!=!1)$. <a href="#Yule1925">(Yule 1925)</a> and later <a href="#Kendall1948">(Kendall 1948)</a> derived
the probability that a process survives ($N(T) &gt; 0$) and the probability
of obtaining exactly $n$ species at time $T$ ($N(T) = n$) when the
process started at time $t$ with one species. Kendall’s results were
summarized in Equation (3) and Equation (24) in <a href="#Nee1994b">(Nee et al. 1994)</a>
<script type="math/tex">% <![CDATA[
\begin{aligned}
P(N(T)\!>\!0|N(t)\!=\!1) & = & \left(1+\int\limits_t^{T} \bigg(\mu(s) \exp(r(t,s))\bigg) ds\right)^{-1} \label{eq:survival} \\ \nonumber \\
P(N(T)\!=\!n|N(t)\!=\!1) & = & (1-P(N(T)\!>\!0|N(t)\!=\!1)\exp(r(t,T)))^{n-1} \nonumber\\
& & \times P(N(T)\!>\!0|N(t)\!=\!1)^2 \exp(r(t,T)) \label{eq:N} %]]></script> An
overview for different diversification models is given in
<a href="#Hoehna2015a">(Höhna 2015)</a>.</p>

<p><strong><em>Sidebar: Phylogenetic trees as observations</em></strong></p>

<p>The branching processes used here describe probability distributions on
phylogenetic trees. This probability distribution can be used to infer
diversification rates given an “observed” phylogenetic tree. In reality
we never observe a phylogenetic tree itself. Instead, phylogenetic trees
themselves are estimated from actual observations, such as DNA
sequences. These phylogenetic tree estimates, especially the divergence
times, can have considerable uncertainty associated with them. Thus, the
correct approach for estimating diversification rates is to include the
uncertainty in the phylogeny by, for example, jointly estimating the
phylogeny and diversification rates. For the simplicity of the following
tutorials, we take a shortcut and assume that we know the phylogeny
without error. For publication quality analysis you should always
estimate the diversification rates jointly with the phylogeny and
divergence times.</p>

<h1 id="estimating-speciation--extinction-rates-through-time">Estimating Speciation &amp; Extinction Rates Through Time</h1>

<h2 id="outline">Outline</h2>

<p>This tutorial describes how to specify different models of incomplete
taxon sampling (missing reference) for estimating
diversification rates in <code class="highlighter-rouge">RevBayes</code> <a href="#Hoehna2016b">(Höhna et al. 2016)</a>. Incomplete taxon
sampling, if not modeled correctly, severely biases diversification-rate
parameter estimates (missing reference). Specifically, we will
discuss <em>uniform</em>, <em>diversified</em>, and <em>empirical</em> taxon sampling. All
analyses in this tutorial will focus on diversification rate estimation
through-time and use a birth-death process where diversification rates
vary episodically which we model by piecewise constant rates <code class="highlighter-rouge">RevBayes</code>
(missing reference). The probabilistic graphical model is given
only once for this tutorial as an overview. The model itself does not
change between the different analyses; only the assumptions of
incomplete taxon sampling. For each analysis you will estimate
speciation and extinction rates through-time using Markov chain Monte
Carlo (MCMC) and assess the impact of incomplete taxon sampling as well
as the sampling scheme.</p>

<h2 id="requirements">Requirements</h2>

<p>We assume that you have read and hopefully completed the following
tutorials:</p>

<ul>
  <li>
    <p><a href="https://github.com/revbayes/revbayes_tutorial/raw/master/tutorial_TeX/RB_Getting_Started/RB_Getting_Started.pdf">Getting
started</a></p>
  </li>
  <li>
    <p><a href="https://github.com/revbayes/revbayes_tutorial/raw/master/tutorial_TeX/RB_Intro_Tutorial/RB_Intro_Tutorial.pdf">Very Basic Introduction to
<code class="highlighter-rouge">Rev</code></a></p>
  </li>
  <li>
    <p><a href="https://github.com/revbayes/revbayes_tutorial/raw/master/tutorial_TeX/RB_Rev_Tutorial/RB_Rev_Tutorial.pdf">General Introduction to the <code class="highlighter-rouge">Rev</code>
syntax</a></p>
  </li>
  <li>
    <p><a href="https://github.com/revbayes/revbayes_tutorial/raw/master/tutorial_TeX/RB_MCMC_Archery_Tutorial/RB_MCMC_Archery_Tutorial.pdf">General Introduction to MCMC using an archery
example</a></p>
  </li>
  <li>
    <p><a href="https://github.com/revbayes/revbayes_tutorial/raw/master/tutorial_TeX/RB_MCMC_Binomial_Tutorial/RB_MCMC_Binomial_Tutorial.pdf">General Introduction to MCMC using a coin-flipping
example</a></p>
  </li>
  <li>
    <p><a href="https://github.com/revbayes/revbayes_tutorial/raw/master/tutorial_TeX/RB_DiversificationRate_Tutorial/RB_DiversificationRate_Tutorial.pdf">Basic Diversification Rate
Estimation</a></p>
  </li>
  <li>
    <p><a href="https://github.com/revbayes/revbayes_tutorial/raw/master/tutorial_TeX/RB_DiversificationRate_Episodic_Tutorial/RB_DiversificationRate_Episodic_Tutorial.pdf">Diversification Rates Through
Time</a></p>
  </li>
</ul>

<p>Note that the <a href="https://github.com/revbayes/revbayes_tutorial/raw/master/tutorial_TeX/RB_Intro_Tutorial/RB_Intro_Tutorial.pdf"><code class="highlighter-rouge">Rev</code> basics
tutorial</a>
introduces the basic syntax of <code class="highlighter-rouge">Rev</code> but does not cover any phylogenetic
models. We tried to keep this tutorial very basic and introduce all the
language concepts and theory on the way. You may only need the <a href="https://github.com/revbayes/revbayes_tutorial/raw/master/tutorial_TeX/RB_Rev_Tutorial/RB_Rev_Tutorial.pdf"><code class="highlighter-rouge">Rev</code>
syntax
tutorial</a>
for a more in-depth discussion of concepts in <code class="highlighter-rouge">Rev</code>.</p>

<p>For this tutorial it is especially important that you have read the two
tutorials on diversification rate estimation: <a href="https://github.com/revbayes/revbayes_tutorial/raw/master/tutorial_TeX/RB_DiversificationRate_Tutorial/RB_DiversificationRate_Tutorial.pdf">Basic Diversification
Rate Estimation
tutorial</a>
and <a href="https://github.com/revbayes/revbayes_tutorial/raw/master/tutorial_TeX/RB_DiversificationRate_Episodic_Tutorial/RB_DiversificationRate_Episodic_Tutorial.pdf">Diversification Rates Through Time
tutorial</a>.
Specifically the <a href="https://github.com/revbayes/revbayes_tutorial/raw/master/tutorial_TeX/RB_DiversificationRate_Episodic_Tutorial/RB_DiversificationRate_Episodic_Tutorial.pdf">Diversification Rates Through Time
tutorial</a>
present the underlying diversification model and thus foundation for
this tutorial. Here we will build on the tutorial by modifying the
assumptions of incomplete taxon sampling in different ways.</p>

<h1 id="data-and-files">Data and files</h1>

<p>We provide the data file(s) which we will use in this tutorial. You may
want to use your own data instead. In the ‘data‘ folder, you will find
the following file</p>

<ul>
  <li>‘primates.tre‘: Dated primates phylogeny including 23 out of
377 species.</li>
</ul>

<p>Note that we use here the small primate phylogeny including only 23 of
the 377 taxa instead of the much more complete primate phylogeny from
<a href="#Springer2012">(Springer et al. 2012)</a>. This choice was solely made to emphasize the point and
impact of incomplete taxon sampling, which is a very prominent feature
in many large scale phylogenies.</p>

<p>Open the tree ‘data/primates.tre‘ in
<code class="highlighter-rouge">FigTree</code>.</p>

<blockquote class="figure">
  <p><img src="figures/EBD_scenarios.png" alt="" /> 
Two scenarios of
birth-death models. On the left we show constant diversification. On the
right we show an example of an episodic birth-death process where rates
are constant in each time interval (epoch). The top panel of this figure
shows example realization under the given rates.</p>
</blockquote>

<h1 id="episodic-birth-death-model">Episodic Birth-Death Model</h1>

<p>Here we study the impact of incomplete taxon sampling by estimating
diversification rates through time. The goal is to compare the impact of
different taxon sampling strategies rather than the description of the
diversification-rate model itself. The episodic birth-death model used
here is equivalent to the model described in our previous tutorial.
Please read the <a href="https://github.com/revbayes/revbayes_tutorial/raw/master/tutorial_TeX/RB_DiversificationRate_Episodic_Tutorial/RB_DiversificationRate_Episodic_Tutorial.pdf">Diversification Rates Through
Time</a>
tutorial for more detailed information about the model.</p>

<p>We have included in Figure [fig:EBD] again the cartoon of episodic
birth-death process with piecewise constant diversification rates. As
mentioned above, diversification rate estimates are biased when only a
fraction of the species is included and the sampling scheme is not
accommodated appropriately
(missing reference). Hence, the
diversification rate through time model will be an excellent example to
study the impact of the assumed incomplete sampling strategy on
diversification rates.</p>

<blockquote>
  <p><img src="figures/graphical_model_EBD.png" alt="" /> 
A graphical model
with the outline of the <code class="highlighter-rouge">Rev</code> code. On the left we see the graphical
model describing the correlated (Brownian motion) model for
rate-variation through time. On the right we show the correspond <code class="highlighter-rouge">Rev</code>
commands to instantiate this model in computer memory. This figure gives
a complete overview of the model that we use here in this analysis.</p>
</blockquote>

<p class="figure">We additionally include the graphical model representing the episodic
birth-death process with autocorrelated diversification rates. This
graphical model shows you which variables are included in the model, and
the dependency between the variables. Thus, it makes the structure and
assumption of the model clear and visible instead of a black-box
<a href="#Hoehna2014b">(Höhna et al. 2014)</a>. Here we will focus only on the variable ‘rho‘, the
sampling probability, to model incomplete taxon sampling.</p>

<h2 id="specifying-the-model-in-rev">Specifying the model in <code class="highlighter-rouge">Rev</code></h2>

<p>We will give a very brief and compressed version of the model with fewer
comments and explanation. The more detailed explanation can be found in
the <a href="https://github.com/revbayes/revbayes_tutorial/raw/master/tutorial_TeX/RB_DiversificationRate_Episodic_Tutorial/RB_DiversificationRate_Episodic_Tutorial.pdf">Diversification Rates Through Time
tutorial</a>.
Any attempt from us to present the full description here would only be a
duplication/copy of the original tutorial with the additional to be less
complete and less up to date.</p>

<p>Here are the summarized steps for running the episodic birth-death model
in <code class="highlighter-rouge">Rev</code>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#######################
# Reading in the Data #
#######################

### Read in the "observed" tree
T &lt;- readTrees("data/primates.tre")[1]

# Get some useful variables from the data. We need these later on.
taxa &lt;- T.taxa()

# set my move index
mvi = 0
mni = 0

NUM_INTERVALS = 10



####################
# Create the rates #
####################

# first we create the standard deviation of the rates between intervals
# draw the sd from an exponential distribution
speciation_sd ~ dnExponential(1.0)
moves[++mvi] = mvScale(speciation_sd,weight=5.0)

extinction_sd ~ dnExponential(1.0)
moves[++mvi] = mvScale(extinction_sd,weight=5.0)


# create a random variable at the present time
log_speciation[1] ~ dnUniform(-10.0,10.0)
log_extinction[1] ~ dnUniform(-10.0,10.0)


# apply moves on the rates
moves[++mvi] = mvSlide(log_speciation[1], weight=2)
moves[++mvi] = mvSlide(log_extinction[1], weight=2)


speciation[1] := exp( log_speciation[1] )
extinction[1] := exp( log_extinction[1] )


for (i in 1:NUM_INTERVALS) {
    index = i+1
    
    # specify normal priors (= Brownian motion) on the log of the rates
    log_speciation[index] ~ dnNormal( mean=log_speciation[i], sd=speciation_sd )
    log_extinction[index] ~ dnNormal( mean=log_extinction[i], sd=extinction_sd )

    # apply moves on the rates
    moves[++mvi] = mvSlide(log_speciation[index], weight=2)
    moves[++mvi] = mvSlide(log_extinction[index], weight=2)

    # transform the log-rate into actual rates
    speciation[index] := exp( log_speciation[index] )
    extinction[index] := exp( log_extinction[index] )

}

moves[++mvi] = mvVectorSlide(log_speciation, weight=10)
moves[++mvi] = mvVectorSlide(log_extinction, weight=10)

moves[++mvi] = mvShrinkExpand( log_speciation, sd=speciation_sd, weight=10 )
moves[++mvi] = mvShrinkExpand( log_extinction, sd=extinction_sd, weight=10 )


interval_times &lt;- T.rootAge() * (1:NUM_INTERVALS) / (NUM_INTERVALS) * 0.8


### rho is the probability of sampling species at the present
### fix this to 23/377, since there are ~377 described species of primates
### and we have sampled 23
rho &lt;- T.ntips()/377

timetree ~ dnEpisodicBirthDeath(rootAge=T.rootAge(), lambdaRates=speciation, lambdaTimes=interval_times, muRates=extinction, muTimes=interval_times, rho=rho, samplingStrategy="uniform", condition="survival", taxa=taxa)

### clamp the model with the "observed" tree
timetree.clamp(T)



#############
# The Model #
#############


### workspace model wrapper ###
mymodel = model(timetree)

### set up the monitors that will output parameter values to file and screen 
monitors[++mni] = mnModel(filename="output/primates_uniform.log",printgen=10, separator = TAB)
monitors[++mni] = mnFile(filename="output/primates_uniform_speciation_rates.log",printgen=10, separator = TAB, speciation)
monitors[++mni] = mnFile(filename="output/primates_uniform_speciation_times.log",printgen=10, separator = TAB, interval_times)#
monitors[++mni] = mnFile(filename="output/primates_uniform_extinction_rates.log",printgen=10, separator = TAB, extinction)
monitors[++mni] = mnFile(filename="output/primates_uniform_extinction_times.log",printgen=10, separator = TAB, interval_times)
monitors[++mni] = mnScreen(printgen=1000, extinction_sd, speciation_sd)



################
# The Analysis #
################

### workspace mcmc ###
mymcmc = mcmc(mymodel, monitors, moves)

### pre-burnin to tune the proposals ###
mymcmc.burnin(generations=10000,tuningInterval=200)

### run the MCMC ###
mymcmc.run(generations=50000)
</code></pre></div></div>

<p>This <code class="highlighter-rouge">Rev</code> code shows the template for estimating episodic
diversification rates. In the next sections we will tweak the script for
the different sampling schemes.</p>

<h1 id="uniform-taxon-sampling">Uniform Taxon Sampling</h1>

<p>In our first analysis we will assume <em>uniform</em> taxon sampling [see
@Hoehna2011} (missing reference). Uniform taxon sampling corresponds to the
assumption that every species has the same probability $\rho$ to be
included (<em>i.e.,</em>sampled) in our study.
Imagine flipping a coin that has the probability $\rho$ to show up
heads. For every species you flip the coin and are going to include the
species, for example by sequencing it, in your study. This is what the
assumption of uniform taxon sampling means.</p>

<p>For our study, we know that we have sampled 23 out of 377 living primate
species. To account for this we can set the sampling parameter as a
constant variable with a value of 23/377.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rho &lt;- T.ntips()/377
</code></pre></div></div>

<p>Note that in principle you could specify a hyperprior distribution on
the sampling probability ‘rho‘. However, all three parameters
(speciation rate, extinction rate, and sampling probability) are not
identifiable <a href="#Stadler2009">(Stadler 2009)</a>. Nevertheless, we could specify informative
priors on the sampling fraction if, for example, we know that the true
diversity is in same range.</p>

<p>Moreover, we specify the <em>uniform</em> sampling scheme by setting
‘samplingStrategy=“uniform”‘ in the birth-death process.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>timetree ~ dnEpisodicBirthDeath(rootAge=T.rootAge(), lambdaRates=speciation, lambdaTimes=interval_times, muRates=extinction, muTimes=interval_times, rho=rho, samplingStrategy="uniform", condition="survival", taxa=taxa)
</code></pre></div></div>

<p>This is exactly what we did in the <code class="highlighter-rouge">Rev</code> script above.</p>

<p>The <code class="highlighter-rouge">Rev</code> file for performing this analysis:
<a href="https://github.com/revbayes/revbayes_tutorial/raw/master/RB_DiversificationRate_Sampling_Tutorial/scripts/mcmc_uniform.Rev">‘mcmc_uniform.Rev‘</a>.</p>

<h2 id="exercise-1">Exercise 1</h2>

<ul>
  <li>
    <p>Run an MCMC simulation to estimate the posterior distribution of the
speciation rate and extinction rate through time assuming <em>uniform</em>
taxon sampling. You can use the script ‘mcmc_uniform.Rev‘ to run
the analysis.</p>
  </li>
  <li>
    <p>Visualize the rate through time using
<code class="highlighter-rouge">R</code>and <code class="highlighter-rouge">Rev</code>Gadgets.</p>
  </li>
</ul>

<blockquote class="figure">
  <p><img src="figures/uniform.png" alt="" /> 
Resulting diversification rate
estimations when using 20 intervals and assuming uniform taxon sampling.
You should create similar plots for the other sampling schemes and
compare the rates through time.</p>
</blockquote>

<h2 id="summarizing-and-plotting-diversification-rates-through-time">Summarizing and plotting diversification rates through time</h2>

<p>When the analysis is complete, you will have the monitored files in your
output directory. You can then visualize the rates through time using
<code class="highlighter-rouge">R</code>using our package <code class="highlighter-rouge">Rev</code>Gadgets. If you don’t have the
R-package <code class="highlighter-rouge">Rev</code>Gadgets installed, or if you have trouble with the
package, then please read the separate tutorial about the package.</p>

<p>Just start <code class="highlighter-rouge">R</code>in the main directory for this analysis and
then type the following commands:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>library(RevGadgets)

tree &lt;- read.nexus("data/primates.tre")
files &lt;- c("output/primates_uniform_speciation_times.log", "output/primates_uniform_speciation_rates.log", "output/primates_uniform_extinction_times.log", "output/primates_uniform_extinction_rates.log")

rev_out &lt;- rev.process.output(files,tree,burnin=0.25,numIntervals=100)

pdf("uniform.pdf")
par(mfrow=c(2,2))
rev.plot.output(rev_out)
dev.off()
</code></pre></div></div>

<p>You can see the resulting plot in Figure [fig:EBD_Results].</p>

<h1 id="diversified-taxon-sampling">Diversified Taxon Sampling</h1>

<p>In the previous analysis we assumed that species were sampled uniformly.
However, this assumption is very often violated
(missing reference). For example, the primate phylogeny that we
use in this tutorial includes one species for almost all genera. Thus,
we had selected the species for the study neither uniformly nor randomly
but instead by including one species per genera and hence maximizing
diversity. This sampling scheme is called <em>diversified</em> taxon sampling
<a href="#Hoehna2011">(Höhna et al. 2011)</a>.</p>

<blockquote class="figure">
  <p><img src="figures/diversified-sampling.png" alt="" /> 
Example of
diversified taxon sampling. a) An example phylogeny showing that all
species after a certain time are not sampled. b) The cumulative
probability of a speciation event occurring as a function of time. Here
we see that the highest probability for a speciation event is more
recently.</p>
</blockquote>

<p>Figure [fig:DiversifiedSampling] shows an example of diversified
sampling. The example shows the same tree as in Figure [fig:BDP] where
5 species are sampled. In fact, here we sampled 5 species so that every
group is included and the most recent speciation events are excluded
(not sampled).</p>

<p>In <code class="highlighter-rouge">RevBayes</code> we can specify <em>diversified</em> taxon sampling in the same
way as we did <em>uniform</em> taxon sampling. First, we specify a constant
variable for the sampling fraction ‘rho‘ which we set to the number of
included (sampled) taxa divided by the number of total taxa in the
group.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rho &lt;- T.ntips()/377
</code></pre></div></div>

<p>Then, we specify that our sampling strategy was diversified by setting
the argument of the birth-death process
to‘samplingStrategy=“diversified”‘.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>timetree ~ dnEpisodicBirthDeath(rootAge=T.rootAge(), lambdaRates=speciation, lambdaTimes=interval_times, muRates=extinction, muTimes=interval_times, rho=rho, samplingStrategy="diversified", condition="time", taxa=taxa)
</code></pre></div></div>

<p>This is all we needed to do to change our previous script to model
<em>diversified</em> taxon sampling.</p>

<h2 id="exercise-2">Exercise 2</h2>

<ul>
  <li>
    <p>Copy the <code class="highlighter-rouge">Rev</code> script ‘mcmc_uniform.Rev‘ and name
it ‘mcmc_diversified.Rev‘.</p>
  </li>
  <li>
    <p>Make the changes so that you assume now <em>diversified</em>
taxon sampling.</p>
  </li>
  <li>
    <p>Change the file names in the monitors from ‘uniform‘
to ‘diversified‘.</p>
  </li>
  <li>
    <p>Run the analysis and plot the diversification rates.</p>
  </li>
  <li>
    <p>How does the new sampling assumption influence your estimated rates?</p>
  </li>
</ul>

<h1 id="empirical-taxon-sampling">Empirical Taxon Sampling</h1>

<p>Unfortunately, <em>diversified</em> taxon sampling was derived under a strict
mathematical concept that assumes all species that speciated before a
given time were included and all other species were discarded (not
sampled); see Figure [fig:DiversifiedSampling]. The <em>diversified</em>
sampling strategy is clearly to restrictive to be realistic and can bias
parameter estimates too <a href="#Hoehna2014a">(Höhna 2014)</a>. As another alternative we apply
an <em>empirical</em> taxon sampling strategy that uses empirical information
on the clade relationships and speciation times of the missing species.
For example, in the primate phylogeny we know the crown age of
Hominoidea and know that 19 additional speciation events must have
happened between the crown age of the Hominoidea and the present time to
accommodate the 19 missing species (see
Figure [fig:EmpiricalSampling]). In fact, we can obtain for all larger
groups the crown ages and the number of missing species and thus narrow
down with empirical evidence the times when these missing speciation
events have happened.</p>

<blockquote class="figure">
  <p><img src="figures/primates.png" alt="" /> 
Cartoon of empirical taxon
sampling. The triangle in the phylogeny depict clades with missing
species. To illustrate the point we have written the names of higher
taxa on the right with the number of species belonging to them. From
this number of taxa in the clade we can compute how many species are
missing per clade and which crown age the clade.</p>
</blockquote>

<p>In your phylogeny you can count the number of species belonging to a
given clade and thus compute how many species are missing for this
clade. Then, you can pick two or more species to define the clade. These
species will be used to compute the crown age. For example, we use
<em>Pan_paniscus</em> <em>Hylobates_lar</em> to define the <em>Hominoidae</em> clade. If we
would have <em>Homo_sapiens</em> sampled as well then we could additionally
include it in the clade but we could not leave out <em>Hylobates_lar</em>.</p>

<p>In <code class="highlighter-rouge">Rev</code> we specify several clades and give the number of missing
species.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Galagidae             = clade("Galago_senegalensis",  "Otolemur_crassicaudatus", missing= 17)
Lorisidae             = clade("Perodicticus_potto", "Loris_tardigradus", "Nycticebus_coucang", missing=6)
Cheirogaleoidea       = clade("Cheirogaleus_major", "Microcebus_murinus", missing= 19)
Lemuridae             = clade("Lemur_catta", "Varecia_variegata_variegata", missing=17)
Lemuriformes          = clade(Lemuridae, Cheirogaleoidea, missing=29)
Atelidae_Aotidae      = clade("Alouatta_palliata", "Aotus_trivirgatus", missing=30)
NWM                   = clade(Atelidae_Aotidae,"Callicebus_donacophilus", "Saimiri_sciureus", "Cebus_albifrons", missing=93)
Hominoidea            = clade("Pan_paniscus", "Hylobates_lar", missing=19)
Cercopithecoidea      = clade("Colobus_guereza", "Macaca_mulatta", "Chlorocebus_aethiops", missing=60)
</code></pre></div></div>

<p>Next, we combine all clades into a single vector for later use.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>missing_species_per_clade = v(Galagidae, Lorisidae, Cheirogaleoidea, Lemuridae, Lemuriformes, Atelidae_Aotidae, NWM, Hominoidea, Cercopithecoidea)
</code></pre></div></div>

<p>In the birth-death model we include these missing speciation events by
integrating over the known interval when these speciation events have
happened (between the crown age and the present). This integral of the
probability density of a speciation event is exactly the same as one
minus the cumulative distribution function of a speciation event,
<script type="math/tex">F(t|N(t_1)=1,t_1\leq t \leq T) = 1 - \frac{1-P(N(T)>0|N(t)=1)\exp{(r(t,T))}}{1-P(N(T)>0|N(t_1)=1)\exp{(r(t_1,T))}} \label{spec_dist}</script>
which was previously derived by @Hoehna2014a [Equation (6)] (see also
@Yang1997 [Equation (3)] for constant rates and @Hoehna2013
[Equation (8)]).</p>

<p>Let us define $\mathbb{K}$ as the set of missing species and
$|\mathbb{K}|$ the number of clades with missing species. In our example
we have $|\mathbb{K}| = 9$ clades. Additionally, we define $c_i$ as the
time of most recent common ancestor of the $i^{th}$ clade.</p>

<p>Then, the joint probability density of the sampled reconstructed tree
and the empirically informed missing speciation times is
<script type="math/tex">% <![CDATA[
\begin{aligned}
f(\Psi,\mathbb{K}|N(t_1\!=\!0)\!=\!2,S(2,t_1\!=\!0,T))  & = & f(\Psi|N(t_1\!=\!0)\!=\!2,S(2,t_1\!=\!0,T)) \nonumber \\
& &  \times\prod_{i=1}^{|\mathbb{K}|}\left(1-F(t|N(c_{i})=1,c_{i}\leq t \leq T)\right)^{k_i}  \nonumber\\ \label{eq:timesAndMissing}\end{aligned} %]]></script>
Equation ([eq:timesAndMissing]) is actually proportional to the
original equation under the birth-death process times the probabilities
of the missing species. There are two things to consider when specifying
empirical taxon sampling in <code class="highlighter-rouge">RevBayes</code>. First, we set the “traditional”
sampling fraction to one (‘rho=1.0‘). Second, we provide the clades with
missing species as an argument of the birth-death model
(‘incompleteClades=missing_species_per_clade‘).</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>timetree ~ dnEpisodicBirthDeath(rootAge=T.rootAge(), lambdaRates=speciation, lambdaTimes=interval_times, muRates=extinction, muTimes=interval_times, rho=1.0, taxa=taxa, incompleteClades=missing_species_per_clade, condition="time")
</code></pre></div></div>

<p>These are the only necessary changes to perform a diversification rate
analysis under <em>empirical</em> taxon sampling.</p>

<h2 id="exercise-3">Exercise 3</h2>

<ul>
  <li>
    <p>Copy the <code class="highlighter-rouge">Rev</code> script ‘mcmc_uniform.Rev‘ and name
it ‘mcmc_empirical.Rev‘.</p>
  </li>
  <li>
    <p>Make the changes so that you assume now <em>empirical</em> taxon sampling.</p>
  </li>
  <li>
    <p>Change the file names in the monitors from ‘uniform‘ to ‘empirical‘.</p>
  </li>
  <li>
    <p>Run the analysis and plot the diversification rates.</p>
  </li>
  <li>
    <p>How does the new sampling assumption influence your estimated rates?</p>
  </li>
</ul>


<ol class="bibliography"><li><span id="Condamine2013">Condamine F.L., Rolland J., Morlon H. 2013. Macroevolutionary perspectives to environmental change. Ecology Letters.</span>

<a href="https://doi.org/10.1111/ele.12062">10.1111/ele.12062</a>

</li>
<li><span id="Drummond2012">Drummond A.J., Suchard M.A., Xie D., Rambaut A. 2012. Bayesian phylogenetics with BEAUti and the BEAST 1.7. Molecular Biology and Evolution. 29:1969–1973.</span>

<a href="https://doi.org/10.1093/molbev/mss075">10.1093/molbev/mss075</a>

</li>
<li><span id="Hoehna2016b">Höhna S., Landis M.J., Heath T.A., Boussau B., Lartillot N., Moore B.R., Huelsenbeck J.P., Ronquist F. 2016. RevBayes: Bayesian Phylogenetic Inference Using Graphical Models and an Interactive Model-Specification Language. Systematic Biology. 65:726–736.</span>

<a href="https://doi.org/10.1093/sysbio/syw021">10.1093/sysbio/syw021</a>

</li>
<li><span id="Heath2014">Heath T.A., Huelsenbeck J.P., Stadler T. 2014. The fossilized birth-death process for coherent calibration of divergence-time estimates. Proceedings of the National Academy of Sciences. 111:E2957–E2966.</span>

<a href="https://doi.org/10.1073/pnas.1319091111">10.1073/pnas.1319091111</a>

</li>
<li><span id="Hoehna2014a">Höhna S. 2014. Likelihood Inference of Non-Constant Diversification Rates with Incomplete Taxon Sampling. PLoS One. 9:e84184.</span>

<a href="https://doi.org/10.1371/journal.pone.0084184">10.1371/journal.pone.0084184</a>

</li>
<li><span id="Hoehna2015a">Höhna S. 2015. The time-dependent reconstructed evolutionary process with a key-role for mass-extinction events. Journal of Theoretical Biology. 380:321–331.</span>

<a href="https://doi.org/http://dx.doi.org/10.1016/j.jtbi.2015.06.005">http://dx.doi.org/10.1016/j.jtbi.2015.06.005</a>

</li>
<li><span id="Hoehna2014b">Höhna S., Heath T.A., Boussau B., Landis M.J., Ronquist F., Huelsenbeck J.P. 2014. Probabilistic Graphical Model Representation in Phylogenetics. Systematic Biology. 63:753–771.</span>

<a href="https://doi.org/10.1093/sysbio/syu039">10.1093/sysbio/syu039</a>

</li>
<li><span id="Hoehna2011">Höhna S., Stadler T., Ronquist F., Britton T. 2011. Inferring speciation and extinction rates under different species sampling schemes. Molecular Biology and Evolution. 28:2577–2589.</span>

</li>
<li><span id="Kendall1948">Kendall D.G. 1948. On the Generalized "Birth-and-Death" Process. The Annals of Mathematical Statistics. 19:1–15.</span>

<a href="https://doi.org/10.1214/aoms/1177730285">10.1214/aoms/1177730285</a>

</li>
<li><span id="Maddison2007">Maddison W.P., Midford P.E., Otto S.P. 2007. Estimating a binary character’s effect on speciation and extinction. Systematic Biology. 56:701.</span>

<a href="https://doi.org/10.1080/10635150701607033">10.1080/10635150701607033</a>

</li>
<li><span id="May2016">May M.R., Höhna S., Moore B.R. 2016. A Bayesian Approach for Detecting the Impact of Mass-Extinction Events on Molecular Phylogenies When Rates of Lineage Diversification May Vary. Methods in Ecology and Evolution. 7:947–959.</span>

<a href="https://doi.org/10.1111/2041-210X.12563">10.1111/2041-210X.12563</a>

</li>
<li><span id="Nee1994b">Nee S., May R.M., Harvey P.H. 1994. The Reconstructed Evolutionary Process. Philosophical Transactions: Biological Sciences. 344:305–311.</span>

<a href="https://doi.org/10.1098/rstb.1994.0068">10.1098/rstb.1994.0068</a>

</li>
<li><span id="Ronquist2012">Ronquist F., Teslenko M., Mark P. van der, Ayres D.L., Darling A., Höhna S., Larget B., Liu L., Suchard M.A., Huelsenbeck J.P. 2012. MrBayes 3.2: efficient Bayesian phylogenetic inference and model choice across a large model space. Systematic Biology. 61:539–542.</span>

<a href="https://doi.org/10.1093/sysbio/sys029">10.1093/sysbio/sys029</a>

</li>
<li><span id="Springer2012">Springer M.S., Meredith R.W., Gatesy J., Emerling C.A., Park J., Rabosky D.L., Stadler T., Steiner C., Ryder O.A., Janečka J.E., others. 2012. Macroevolutionary dynamics and historical biogeography of primate diversification inferred from a species supermatrix. PLoS One. 7:e49521.</span>

<a href="https://doi.org/10.1371/journal.pone.0049521">10.1371/journal.pone.0049521</a>

</li>
<li><span id="Stadler2009">Stadler T. 2009. On incomplete sampling under birth-death models and connections to the sampling-based coalescent. Journal of Theoretical Biology. 261:58–66.</span>

<a href="https://doi.org/10.1016/j.jtbi.2009.07.018">10.1016/j.jtbi.2009.07.018</a>

</li>
<li><span id="Yule1925">Yule G.U. 1925. A mathematical theory of evolution, based on the conclusions of Dr. JC Willis, FRS. Philosophical Transactions of the Royal Society of London. Series B, Containing Papers of a Biological Character. 213:21–87.</span>

</li></ol>

<script type="text/javascript">
var _ol = document.querySelectorAll('ol');
for (var i = 0, elem_ol; elem_ol = _ol[i]; i++) {
	if ( elem_ol.classList == "bibliography" ) {
		var _li = elem_ol.getElementsByTagName("li");
		//for (var j = 0, elem_li; elem_li = _li[j]; j++)
		//{
		//	elem_li.innerHTML = elem_li.innerHTML.replace(/(https?:\/\/)([^\s<]+)/,"<a href=\"$1$2\">$2");
		//}
		if(_li.length > 0)
			elem_ol.outerHTML = "<h2 class='references'>References</h2><hr class='references'>"+elem_ol.outerHTML
	}
}
</script>

      <br>
<footer>
  <div class="container">
  <div class="row">
    <div class="col-sm-12" align="center">
      <a href="https://github.com/revbayes">GitHub</a> | <a href="/license">License</a> | <a href="/citation">Citation</a> | <a href="https://groups.google.com/forum/#!forum/revbayes-users">Users Forum</a>
    </div>
  </div>
  <br>
  </div>
</footer>

    </div>
    <script src="/assets/js/vendor/jquery.min.js"></script>
<script src="/assets/js/vendor/FileSaver.min.js"></script>
<script src="/assets/js/vendor/jszip.min.js"></script>
<script src="/assets/js/vendor/bootstrap.min.js"></script>

<script type="text/javascript">
// Add default language
$(":not(code).highlighter-rouge").each(function() {
  
  if( this.classList == "highlighter-rouge") {
    this.classList = "Rev highlighter-rouge";
  }
  
});
// $("code.highlighter-rouge").each(function() {
//   
//   if( this.classList == "highlighter-rouge") {
//       this.classList = "Rev highlighter-rouge";
//   }
//   
// });
</script>

<script src="/assets/js/base.js"></script>

<script type="text/javascript"
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      processEscapes: true
    }
  });
</script>

  </body>
</html>
